<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="./styles.css" />
  <style>
    @import url('https://fonts.googleapis.com/css?family=Lato|Pacifico|Roboto|Shadows+Into+Light');
  </style>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>

</head>

<body class="body">
  <div class="maincontainer">
    <div class="container">
      <div class="heartcontainer">
        <div>
          <span class="title">i</span>
          <span class="glyphicon glyphicon glyphicon-heart heartbeat" aria-hidden="true"></span>
          <span class="title">u</span>
        </div>
        <div class="title">so much</div>
        <div class="subtitle">isabelle!</div>
      </div>
    </div>
  </div>
  <script>
    const heartIcon = document.querySelector('.glyphicon-heart');
    const heartParentContainer = heartIcon.closest('.heartcontainer');
    const originalBgColor = '#caf9ca'; // Defined in styles.css for .heartcontainer
    const bodyEl = document.body;

    heartIcon.addEventListener('click', () => {
      // 1. Heart container background flash
      heartParentContainer.style.backgroundColor = 'white';
      setTimeout(() => {
        heartParentContainer.style.backgroundColor = originalBgColor;
      }, 3500);

      // 2. Heart container text color animation
      heartParentContainer.classList.remove('rainbow-text-animation');
      void heartParentContainer.offsetWidth; // Force reflow
      heartParentContainer.classList.add('rainbow-text-animation');

      // 3. Body background rainbow gradient animation
      bodyEl.classList.remove('body-rainbow-gradient-animation');
      void bodyEl.offsetWidth; // Force reflow
      bodyEl.classList.add('body-rainbow-gradient-animation');

      setTimeout(() => {
        bodyEl.classList.remove('body-rainbow-gradient-animation');
      }, 7500); // Remove after 7.5 seconds, allowing CSS transition for body to take over
    });

    // Add a single event listener for animationend to clean up the text animation class
    if (!heartParentContainer._animationEndHandlerAttached) {
        heartParentContainer.addEventListener('animationend', function(event) {
            if (event.animationName === 'rainbowText' && event.target === this) {
                this.classList.remove('rainbow-text-animation');
            }
        });
        heartParentContainer._animationEndHandlerAttached = true;
    }
  </script>
</body>

</html>